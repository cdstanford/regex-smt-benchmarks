;---
; using 8-bit bit-vectors as characters
; check membership of .Net regex
; regexA = ([\w\-\.]*)@(([\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3})|([\w\-]+\.)+(((af|ax|al|dz|as|ad|ao|ai|aq|ag|am|aw|au|at|az|bs|bh|bd|bb|by|be|bz|bj|bm|bt|bo|ba|bw|bv|br|io|bn|bg|bf|kh|cm|ca|cv|ky|cf|td|cl|cn|cx|cc|km|cg|cd|ck|cr|ci|hr|cu|cy|cz|dk|dj|dm|do|ec|eg|sv|gq|er|ee|et|fk|fo|fj|fi|fr|gf|pf|tf|ga|gm|ge|de|gh|gi|gr|gl|gd|gp|gu|gt| gg|gn|gw|gy|ht|hm|va|hn|hk|hu|is|id|ir|iq|ie|im|il|it|jm|jp|je|jo|kz|ke|ki|kp|kr|kw|kg|la|lv|lb|ls|lr|ly|li|lt|lu|mo|mk|mg|mw|my|mv|ml|mt|mh|mq|mr|yt|mx|fm|md|mc|mn|ms|ma|mz|mm|nr|np|nl|an|nc|nz|ni|ng|nu|nf|mp|no|om|pk|pw|ps|pa|pg|py|pe|ph|pn|pl|pt|qa|re|ro|ru|rw|sh|kn|lc|pm|vc|ws|sm|st|sa|sn|cs|sc|sl|sg|sk|si|sb|so|za|gs|es|lk|sd|sr|sj|sz|se|ch|sy|tw|tj|tz|th|tl|tg|tk|to|tt|tn|tr|tm|tc|tv|ug|ua|gb|us|um|uy|uz|vu|ve|vn|vg|vi|wf|eh|ye|zm|zw|uk|com|edu|gov|int|mil|net|org|biz|info|name|pro|aero|coop|museum|arpa|co|in|ne|bi|na|pr|ae|mu|ar)))?)
;---
(set-info :status sat)
;(set-option :print-success true)
(set-logic QF_S)

(declare-const regexA RegLan)
(declare-const x String)

;witness1: "\u00E6@9.59.85.379"
(define-fun Witness1 () String (str.++ "\u{e6}" (str.++ "@" (str.++ "9" (str.++ "." (str.++ "5" (str.++ "9" (str.++ "." (str.++ "8" (str.++ "5" (str.++ "." (str.++ "3" (str.++ "7" (str.++ "9" ""))))))))))))))
;witness2: "z0@dk.2.\u00B5\u00AA.\u00E6.\u00C3\u00B5\u00BA8\u00AA.9.pe\u00D5\u00C9\u00FB^>"
(define-fun Witness2 () String (str.++ "z" (str.++ "0" (str.++ "@" (str.++ "d" (str.++ "k" (str.++ "." (str.++ "2" (str.++ "." (str.++ "\u{b5}" (str.++ "\u{aa}" (str.++ "." (str.++ "\u{e6}" (str.++ "." (str.++ "\u{c3}" (str.++ "\u{b5}" (str.++ "\u{ba}" (str.++ "8" (str.++ "\u{aa}" (str.++ "." (str.++ "9" (str.++ "." (str.++ "p" (str.++ "e" (str.++ "\u{d5}" (str.++ "\u{c9}" (str.++ "\u{fb}" (str.++ "^" (str.++ ">" "")))))))))))))))))))))))))))))

(assert (= regexA (re.++ (re.* (re.union (re.range "-" ".")(re.union (re.range "0" "9")(re.union (re.range "A" "Z")(re.union (re.range "_" "_")(re.union (re.range "a" "z")(re.union (re.range "\u{aa}" "\u{aa}")(re.union (re.range "\u{b5}" "\u{b5}")(re.union (re.range "\u{ba}" "\u{ba}")(re.union (re.range "\u{c0}" "\u{d6}")(re.union (re.range "\u{d8}" "\u{f6}") (re.range "\u{f8}" "\u{ff}"))))))))))))(re.++ (re.range "@" "@") (re.union (re.++ ((_ re.loop 1 3) (re.range "0" "9"))(re.++ (re.range "." ".")(re.++ ((_ re.loop 1 3) (re.range "0" "9"))(re.++ (re.range "." ".")(re.++ ((_ re.loop 1 3) (re.range "0" "9"))(re.++ (re.range "." ".") ((_ re.loop 1 3) (re.range "0" "9")))))))) (re.++ (re.+ (re.++ (re.+ (re.union (re.range "-" "-")(re.union (re.range "0" "9")(re.union (re.range "A" "Z")(re.union (re.range "_" "_")(re.union (re.range "a" "z")(re.union (re.range "\u{aa}" "\u{aa}")(re.union (re.range "\u{b5}" "\u{b5}")(re.union (re.range "\u{ba}" "\u{ba}")(re.union (re.range "\u{c0}" "\u{d6}")(re.union (re.range "\u{d8}" "\u{f6}") (re.range "\u{f8}" "\u{ff}")))))))))))) (re.range "." "."))) (re.opt (re.union (str.to_re (str.++ "a" (str.++ "f" "")))(re.union (str.to_re (str.++ "a" (str.++ "x" "")))(re.union (str.to_re (str.++ "a" (str.++ "l" "")))(re.union (str.to_re (str.++ "d" (str.++ "z" "")))(re.union (str.to_re (str.++ "a" (str.++ "s" "")))(re.union (str.to_re (str.++ "a" (str.++ "d" "")))(re.union (str.to_re (str.++ "a" (str.++ "o" "")))(re.union (str.to_re (str.++ "a" (str.++ "i" "")))(re.union (str.to_re (str.++ "a" (str.++ "q" "")))(re.union (str.to_re (str.++ "a" (str.++ "g" "")))(re.union (str.to_re (str.++ "a" (str.++ "m" "")))(re.union (str.to_re (str.++ "a" (str.++ "w" "")))(re.union (str.to_re (str.++ "a" (str.++ "u" "")))(re.union (str.to_re (str.++ "a" (str.++ "t" "")))(re.union (str.to_re (str.++ "a" (str.++ "z" "")))(re.union (str.to_re (str.++ "b" (str.++ "s" "")))(re.union (str.to_re (str.++ "b" (str.++ "h" "")))(re.union (str.to_re (str.++ "b" (str.++ "d" "")))(re.union (str.to_re (str.++ "b" (str.++ "b" "")))(re.union (str.to_re (str.++ "b" (str.++ "y" "")))(re.union (str.to_re (str.++ "b" (str.++ "e" "")))(re.union (str.to_re (str.++ "b" (str.++ "z" "")))(re.union (str.to_re (str.++ "b" (str.++ "j" "")))(re.union (str.to_re (str.++ "b" (str.++ "m" "")))(re.union (str.to_re (str.++ "b" (str.++ "t" "")))(re.union (str.to_re (str.++ "b" (str.++ "o" "")))(re.union (str.to_re (str.++ "b" (str.++ "a" "")))(re.union (str.to_re (str.++ "b" (str.++ "w" "")))(re.union (str.to_re (str.++ "b" (str.++ "v" "")))(re.union (str.to_re (str.++ "b" (str.++ "r" "")))(re.union (str.to_re (str.++ "i" (str.++ "o" "")))(re.union (str.to_re (str.++ "b" (str.++ "n" "")))(re.union (str.to_re (str.++ "b" (str.++ "g" "")))(re.union (str.to_re (str.++ "b" (str.++ "f" "")))(re.union (str.to_re (str.++ "k" (str.++ "h" "")))(re.union (str.to_re (str.++ "c" (str.++ "m" "")))(re.union (str.to_re (str.++ "c" (str.++ "a" "")))(re.union (str.to_re (str.++ "c" (str.++ "v" "")))(re.union (str.to_re (str.++ "k" (str.++ "y" "")))(re.union (str.to_re (str.++ "c" (str.++ "f" "")))(re.union (str.to_re (str.++ "t" (str.++ "d" "")))(re.union (str.to_re (str.++ "c" (str.++ "l" "")))(re.union (str.to_re (str.++ "c" (str.++ "n" "")))(re.union (str.to_re (str.++ "c" (str.++ "x" "")))(re.union (str.to_re (str.++ "c" (str.++ "c" "")))(re.union (str.to_re (str.++ "k" (str.++ "m" "")))(re.union (str.to_re (str.++ "c" (str.++ "g" "")))(re.union (str.to_re (str.++ "c" (str.++ "d" "")))(re.union (str.to_re (str.++ "c" (str.++ "k" "")))(re.union (str.to_re (str.++ "c" (str.++ "r" "")))(re.union (str.to_re (str.++ "c" (str.++ "i" "")))(re.union (str.to_re (str.++ "h" (str.++ "r" "")))(re.union (str.to_re (str.++ "c" (str.++ "u" "")))(re.union (str.to_re (str.++ "c" (str.++ "y" "")))(re.union (str.to_re (str.++ "c" (str.++ "z" "")))(re.union (str.to_re (str.++ "d" (str.++ "k" "")))(re.union (str.to_re (str.++ "d" (str.++ "j" "")))(re.union (str.to_re (str.++ "d" (str.++ "m" "")))(re.union (str.to_re (str.++ "d" (str.++ "o" "")))(re.union (str.to_re (str.++ "e" (str.++ "c" "")))(re.union (str.to_re (str.++ "e" (str.++ "g" "")))(re.union (str.to_re (str.++ "s" (str.++ "v" "")))(re.union (str.to_re (str.++ "g" (str.++ "q" "")))(re.union (str.to_re (str.++ "e" (str.++ "r" "")))(re.union (str.to_re (str.++ "e" (str.++ "e" "")))(re.union (str.to_re (str.++ "e" (str.++ "t" "")))(re.union (str.to_re (str.++ "f" (str.++ "k" "")))(re.union (str.to_re (str.++ "f" (str.++ "o" "")))(re.union (str.to_re (str.++ "f" (str.++ "j" "")))(re.union (str.to_re (str.++ "f" (str.++ "i" "")))(re.union (str.to_re (str.++ "f" (str.++ "r" "")))(re.union (str.to_re (str.++ "g" (str.++ "f" "")))(re.union (str.to_re (str.++ "p" (str.++ "f" "")))(re.union (str.to_re (str.++ "t" (str.++ "f" "")))(re.union (str.to_re (str.++ "g" (str.++ "a" "")))(re.union (str.to_re (str.++ "g" (str.++ "m" "")))(re.union (str.to_re (str.++ "g" (str.++ "e" "")))(re.union (str.to_re (str.++ "d" (str.++ "e" "")))(re.union (str.to_re (str.++ "g" (str.++ "h" "")))(re.union (str.to_re (str.++ "g" (str.++ "i" "")))(re.union (str.to_re (str.++ "g" (str.++ "r" "")))(re.union (str.to_re (str.++ "g" (str.++ "l" "")))(re.union (str.to_re (str.++ "g" (str.++ "d" "")))(re.union (str.to_re (str.++ "g" (str.++ "p" "")))(re.union (str.to_re (str.++ "g" (str.++ "u" "")))(re.union (str.to_re (str.++ "g" (str.++ "t" "")))(re.union (str.to_re (str.++ " " (str.++ "g" (str.++ "g" ""))))(re.union (str.to_re (str.++ "g" (str.++ "n" "")))(re.union (str.to_re (str.++ "g" (str.++ "w" "")))(re.union (str.to_re (str.++ "g" (str.++ "y" "")))(re.union (str.to_re (str.++ "h" (str.++ "t" "")))(re.union (str.to_re (str.++ "h" (str.++ "m" "")))(re.union (str.to_re (str.++ "v" (str.++ "a" "")))(re.union (str.to_re (str.++ "h" (str.++ "n" "")))(re.union (str.to_re (str.++ "h" (str.++ "k" "")))(re.union (str.to_re (str.++ "h" (str.++ "u" "")))(re.union (str.to_re (str.++ "i" (str.++ "s" "")))(re.union (str.to_re (str.++ "i" (str.++ "d" "")))(re.union (str.to_re (str.++ "i" (str.++ "r" "")))(re.union (str.to_re (str.++ "i" (str.++ "q" "")))(re.union (str.to_re (str.++ "i" (str.++ "e" "")))(re.union (str.to_re (str.++ "i" (str.++ "m" "")))(re.union (str.to_re (str.++ "i" (str.++ "l" "")))(re.union (str.to_re (str.++ "i" (str.++ "t" "")))(re.union (str.to_re (str.++ "j" (str.++ "m" "")))(re.union (str.to_re (str.++ "j" (str.++ "p" "")))(re.union (str.to_re (str.++ "j" (str.++ "e" "")))(re.union (str.to_re (str.++ "j" (str.++ "o" "")))(re.union (str.to_re (str.++ "k" (str.++ "z" "")))(re.union (str.to_re (str.++ "k" (str.++ "e" "")))(re.union (str.to_re (str.++ "k" (str.++ "i" "")))(re.union (str.to_re (str.++ "k" (str.++ "p" "")))(re.union (str.to_re (str.++ "k" (str.++ "r" "")))(re.union (str.to_re (str.++ "k" (str.++ "w" "")))(re.union (str.to_re (str.++ "k" (str.++ "g" "")))(re.union (str.to_re (str.++ "l" (str.++ "a" "")))(re.union (str.to_re (str.++ "l" (str.++ "v" "")))(re.union (str.to_re (str.++ "l" (str.++ "b" "")))(re.union (str.to_re (str.++ "l" (str.++ "s" "")))(re.union (str.to_re (str.++ "l" (str.++ "r" "")))(re.union (str.to_re (str.++ "l" (str.++ "y" "")))(re.union (str.to_re (str.++ "l" (str.++ "i" "")))(re.union (str.to_re (str.++ "l" (str.++ "t" "")))(re.union (str.to_re (str.++ "l" (str.++ "u" "")))(re.union (str.to_re (str.++ "m" (str.++ "o" "")))(re.union (str.to_re (str.++ "m" (str.++ "k" "")))(re.union (str.to_re (str.++ "m" (str.++ "g" "")))(re.union (str.to_re (str.++ "m" (str.++ "w" "")))(re.union (str.to_re (str.++ "m" (str.++ "y" "")))(re.union (str.to_re (str.++ "m" (str.++ "v" "")))(re.union (str.to_re (str.++ "m" (str.++ "l" "")))(re.union (str.to_re (str.++ "m" (str.++ "t" "")))(re.union (str.to_re (str.++ "m" (str.++ "h" "")))(re.union (str.to_re (str.++ "m" (str.++ "q" "")))(re.union (str.to_re (str.++ "m" (str.++ "r" "")))(re.union (str.to_re (str.++ "y" (str.++ "t" "")))(re.union (str.to_re (str.++ "m" (str.++ "x" "")))(re.union (str.to_re (str.++ "f" (str.++ "m" "")))(re.union (str.to_re (str.++ "m" (str.++ "d" "")))(re.union (str.to_re (str.++ "m" (str.++ "c" "")))(re.union (str.to_re (str.++ "m" (str.++ "n" "")))(re.union (str.to_re (str.++ "m" (str.++ "s" "")))(re.union (str.to_re (str.++ "m" (str.++ "a" "")))(re.union (str.to_re (str.++ "m" (str.++ "z" "")))(re.union (str.to_re (str.++ "m" (str.++ "m" "")))(re.union (str.to_re (str.++ "n" (str.++ "r" "")))(re.union (str.to_re (str.++ "n" (str.++ "p" "")))(re.union (str.to_re (str.++ "n" (str.++ "l" "")))(re.union (str.to_re (str.++ "a" (str.++ "n" "")))(re.union (str.to_re (str.++ "n" (str.++ "c" "")))(re.union (str.to_re (str.++ "n" (str.++ "z" "")))(re.union (str.to_re (str.++ "n" (str.++ "i" "")))(re.union (str.to_re (str.++ "n" (str.++ "g" "")))(re.union (str.to_re (str.++ "n" (str.++ "u" "")))(re.union (str.to_re (str.++ "n" (str.++ "f" "")))(re.union (str.to_re (str.++ "m" (str.++ "p" "")))(re.union (str.to_re (str.++ "n" (str.++ "o" "")))(re.union (str.to_re (str.++ "o" (str.++ "m" "")))(re.union (str.to_re (str.++ "p" (str.++ "k" "")))(re.union (str.to_re (str.++ "p" (str.++ "w" "")))(re.union (str.to_re (str.++ "p" (str.++ "s" "")))(re.union (str.to_re (str.++ "p" (str.++ "a" "")))(re.union (str.to_re (str.++ "p" (str.++ "g" "")))(re.union (str.to_re (str.++ "p" (str.++ "y" "")))(re.union (str.to_re (str.++ "p" (str.++ "e" "")))(re.union (str.to_re (str.++ "p" (str.++ "h" "")))(re.union (str.to_re (str.++ "p" (str.++ "n" "")))(re.union (str.to_re (str.++ "p" (str.++ "l" "")))(re.union (str.to_re (str.++ "p" (str.++ "t" "")))(re.union (str.to_re (str.++ "q" (str.++ "a" "")))(re.union (str.to_re (str.++ "r" (str.++ "e" "")))(re.union (str.to_re (str.++ "r" (str.++ "o" "")))(re.union (str.to_re (str.++ "r" (str.++ "u" "")))(re.union (str.to_re (str.++ "r" (str.++ "w" "")))(re.union (str.to_re (str.++ "s" (str.++ "h" "")))(re.union (str.to_re (str.++ "k" (str.++ "n" "")))(re.union (str.to_re (str.++ "l" (str.++ "c" "")))(re.union (str.to_re (str.++ "p" (str.++ "m" "")))(re.union (str.to_re (str.++ "v" (str.++ "c" "")))(re.union (str.to_re (str.++ "w" (str.++ "s" "")))(re.union (str.to_re (str.++ "s" (str.++ "m" "")))(re.union (str.to_re (str.++ "s" (str.++ "t" "")))(re.union (str.to_re (str.++ "s" (str.++ "a" "")))(re.union (str.to_re (str.++ "s" (str.++ "n" "")))(re.union (str.to_re (str.++ "c" (str.++ "s" "")))(re.union (str.to_re (str.++ "s" (str.++ "c" "")))(re.union (str.to_re (str.++ "s" (str.++ "l" "")))(re.union (str.to_re (str.++ "s" (str.++ "g" "")))(re.union (str.to_re (str.++ "s" (str.++ "k" "")))(re.union (str.to_re (str.++ "s" (str.++ "i" "")))(re.union (str.to_re (str.++ "s" (str.++ "b" "")))(re.union (str.to_re (str.++ "s" (str.++ "o" "")))(re.union (str.to_re (str.++ "z" (str.++ "a" "")))(re.union (str.to_re (str.++ "g" (str.++ "s" "")))(re.union (str.to_re (str.++ "e" (str.++ "s" "")))(re.union (str.to_re (str.++ "l" (str.++ "k" "")))(re.union (str.to_re (str.++ "s" (str.++ "d" "")))(re.union (str.to_re (str.++ "s" (str.++ "r" "")))(re.union (str.to_re (str.++ "s" (str.++ "j" "")))(re.union (str.to_re (str.++ "s" (str.++ "z" "")))(re.union (str.to_re (str.++ "s" (str.++ "e" "")))(re.union (str.to_re (str.++ "c" (str.++ "h" "")))(re.union (str.to_re (str.++ "s" (str.++ "y" "")))(re.union (str.to_re (str.++ "t" (str.++ "w" "")))(re.union (str.to_re (str.++ "t" (str.++ "j" "")))(re.union (str.to_re (str.++ "t" (str.++ "z" "")))(re.union (str.to_re (str.++ "t" (str.++ "h" "")))(re.union (str.to_re (str.++ "t" (str.++ "l" "")))(re.union (str.to_re (str.++ "t" (str.++ "g" "")))(re.union (str.to_re (str.++ "t" (str.++ "k" "")))(re.union (str.to_re (str.++ "t" (str.++ "o" "")))(re.union (str.to_re (str.++ "t" (str.++ "t" "")))(re.union (str.to_re (str.++ "t" (str.++ "n" "")))(re.union (str.to_re (str.++ "t" (str.++ "r" "")))(re.union (str.to_re (str.++ "t" (str.++ "m" "")))(re.union (str.to_re (str.++ "t" (str.++ "c" "")))(re.union (str.to_re (str.++ "t" (str.++ "v" "")))(re.union (str.to_re (str.++ "u" (str.++ "g" "")))(re.union (str.to_re (str.++ "u" (str.++ "a" "")))(re.union (str.to_re (str.++ "g" (str.++ "b" "")))(re.union (str.to_re (str.++ "u" (str.++ "s" "")))(re.union (str.to_re (str.++ "u" (str.++ "m" "")))(re.union (str.to_re (str.++ "u" (str.++ "y" "")))(re.union (str.to_re (str.++ "u" (str.++ "z" "")))(re.union (str.to_re (str.++ "v" (str.++ "u" "")))(re.union (str.to_re (str.++ "v" (str.++ "e" "")))(re.union (str.to_re (str.++ "v" (str.++ "n" "")))(re.union (str.to_re (str.++ "v" (str.++ "g" "")))(re.union (str.to_re (str.++ "v" (str.++ "i" "")))(re.union (str.to_re (str.++ "w" (str.++ "f" "")))(re.union (str.to_re (str.++ "e" (str.++ "h" "")))(re.union (str.to_re (str.++ "y" (str.++ "e" "")))(re.union (str.to_re (str.++ "z" (str.++ "m" "")))(re.union (str.to_re (str.++ "z" (str.++ "w" "")))(re.union (str.to_re (str.++ "u" (str.++ "k" "")))(re.union (str.to_re (str.++ "c" (str.++ "o" (str.++ "m" ""))))(re.union (str.to_re (str.++ "e" (str.++ "d" (str.++ "u" ""))))(re.union (str.to_re (str.++ "g" (str.++ "o" (str.++ "v" ""))))(re.union (str.to_re (str.++ "i" (str.++ "n" (str.++ "t" ""))))(re.union (str.to_re (str.++ "m" (str.++ "i" (str.++ "l" ""))))(re.union (str.to_re (str.++ "n" (str.++ "e" (str.++ "t" ""))))(re.union (str.to_re (str.++ "o" (str.++ "r" (str.++ "g" ""))))(re.union (str.to_re (str.++ "b" (str.++ "i" (str.++ "z" ""))))(re.union (str.to_re (str.++ "i" (str.++ "n" (str.++ "f" (str.++ "o" "")))))(re.union (str.to_re (str.++ "n" (str.++ "a" (str.++ "m" (str.++ "e" "")))))(re.union (str.to_re (str.++ "p" (str.++ "r" (str.++ "o" ""))))(re.union (str.to_re (str.++ "a" (str.++ "e" (str.++ "r" (str.++ "o" "")))))(re.union (str.to_re (str.++ "c" (str.++ "o" (str.++ "o" (str.++ "p" "")))))(re.union (str.to_re (str.++ "m" (str.++ "u" (str.++ "s" (str.++ "e" (str.++ "u" (str.++ "m" "")))))))(re.union (str.to_re (str.++ "a" (str.++ "r" (str.++ "p" (str.++ "a" "")))))(re.union (str.to_re (str.++ "c" (str.++ "o" "")))(re.union (str.to_re (str.++ "i" (str.++ "n" "")))(re.union (str.to_re (str.++ "n" (str.++ "e" "")))(re.union (str.to_re (str.++ "b" (str.++ "i" "")))(re.union (str.to_re (str.++ "n" (str.++ "a" "")))(re.union (str.to_re (str.++ "p" (str.++ "r" "")))(re.union (str.to_re (str.++ "a" (str.++ "e" "")))(re.union (str.to_re (str.++ "m" (str.++ "u" ""))) (str.to_re (str.++ "a" (str.++ "r" ""))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))

;check that the regex contains some x
(assert (str.in_re x regexA))
;check also the concrete witnesses
(assert (str.in_re Witness1 regexA))
(assert (str.in_re Witness2 regexA))
(check-sat)
